angular.module("and-loader",[]).factory("andLoader",["$http",function(t){var o=1,s=function(t,s){this.id=o++,this.tasks=[],this.todo=[],this.parent=t||this,this.root=s||this,this.status,this.root==this&&this.root.reset()};return s.prototype.reset=function(){this.status={processed:0,loaded:0,failed:0,total:0}},s.prototype.load=function(){var t=new s(this,this.root);return this.tasks.push(t),t},s.prototype.end=function(){return this.parent},s.prototype.processTasks=function(t){for(var o in this.tasks){var s=this.tasks[o];s._run(t)}},s.prototype.run=function(t){return this.root._run(t)},s.prototype._run=function(o){var s=this,r=0;for(var n in s.todo){var e=s.todo[n];t(e).then(function(t){s.root.status.loaded++,s.root.status.processed++,++r==s.todo.length&&s.processTasks(o),o&&o(s.root.status),t.config.cb&&t.config.cb(t)},function(t){s.root.status.failed++,s.root.status.processed++,++r==s.todo.length&&s.processTasks(o),o&&o(s.root.status),t.config.cb&&t.config.cb(t)})}return this},s.prototype.get=function(t,o){return this.todo.push({url:t,method:"GET",cb:o}),this.root.status.total++,this},s.prototype.post=function(t,o,s){return this.todo.push({url:t,method:"POST",data:o,cb:s}),this.root.status.total++,this},s.prototype.then=function(){return this.parent.load()},function(){return new s}}]);